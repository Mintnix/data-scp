' Gambas class file

Public sDateimanager As String
Public sServerIP As String
Public sBenutzer As String
Public sTerminal As String



Public Sub Form_Open()

Dim hFile As Stream
Dim sLine As String     ' Dateimanager
Dim sLine2 As String    ' ServerIP
Dim sLine3 As String    ' Benutzername
Dim sLine4 As String    ' Terminal
Dim sLine5 As String    ' individuelle Einstellung

hFile = Open "~/.datascp.txt" For Read

   Line Input #hFile, sLine
   Line Input #hFile, sLine2
   Line Input #hFile, sLine3
   Line Input #hFile, sLine4
   Line Input #hFile, sLine5
   '   Print sLine, sLine2, sLine3
   
   ComboBox1.Text = sLine
   TextBox1.Text = sLine2
   TextBox2.Text = sLine3
   sDateimanager = sLine
   sServerIP = sLine2
   sBenutzer = sLine3
   sTerminal = sLine4
   FMain.sGlobal1 = sLine5
   FMain.sGlobal2 = sLine4

' Abfrage falls sLine leer sein sollte
If sLine = "" Then ComboBox1.Text = "Linux auswählen"
If ComboBox1.Text = "Linux auswählen" Then TextBox1.Text = "Server IP-Adresse"
If ComboBox1.Text = "Linux auswählen" Then TextBox2.Text = "Benutzername auf dem Server"


' Hier wird das richtige Terminal für die entsprechende Ubgebung gewählt
If ComboBox1.Text = "Linux Mint 19 - Cinnamon" Then sTerminal = "gnome-terminal" 
If ComboBox1.Text = "Linux Mint 19 - Xfce" Then sTerminal = "xfce4-terminal"
If ComboBox1.Text = "Linux Mint 19 - Mate" Then sTerminal = "mate-terminal" 
If ComboBox1.Text = "Kubuntu 18.04" Then sTerminal = "konsole"
If ComboBox1.Text = "Ubuntu 18.04" Then sTerminal = "gnome-terminal"
If ComboBox1.Text = "eigene Einstellung" Then sTerminal = FMain.sGlobal2

If Exist("~/DataSCP") = True Then Label1.Text = "Arbeitsordner existiert schon."

End





Public Sub Button5_Click()
   ' den SSH Server installieren
   If sTerminal = "xfce4-terminal" Then Shell sTerminal & " -x apt install openssh-server" Else Shell sTerminal & " -- apt install openssh-server" Wait

End
Public Sub Button7_Click()
   ' den Server wieder löschen
   ' Exec ["'apt remove openssh-server'"] Wait
    If sTerminal = "xfce4-terminal" Then Shell sTerminal & " -x apt remove openssh-server" Else Shell sTerminal & " -- apt remove openssh-server" Wait 
    ' Shell sTerminal & " -- apt remove openssh-server" Wait
    

End

Public Sub Button9_Click()
'die eingegeben Daten speichern  / eine einfache Routine ,die funktioniert !!!

   If Exist("~/DataSCP") = False Then Mkdir "~/DataSCP"
   
   
   ' Hier wird das richtige Terminal für die entsprechende Ubgebung gewählt
If ComboBox1.Text = "Linux Mint 19 - Cinnamon" Then sTerminal = "gnome-terminal" 
If ComboBox1.Text = "Linux Mint 19 - Xfce" Then sTerminal = "xfce4-terminal"
If ComboBox1.Text = "Linux Mint 19 - Mate" Then sTerminal = "mate-terminal" 
If ComboBox1.Text = "Kubuntu 18.04" Then sTerminal = "konsole"
If ComboBox1.Text = "Ubuntu 18.04" Then sTerminal = "gnome-terminal"
If ComboBox1.Text = "eigene Einstellung" Then sTerminal = FMain.sGlobal2

   sDateimanager = ComboBox1.Text
   sServerIP = TextBox1.Text
   sBenutzer = TextBox2.Text
   'FMain.sGlobal1 = FMain.sGlobal2
   
      
   File.Save("~/.datascp.txt", sDateimanager & gb.NewLine & sServerIP & gb.NewLine & sBenutzer & gb.NewLine & sTerminal & gb.NewLine & FMain.sGlobal1)
   Catch
' If Error Then Message("Fehler", "ok")
   If Error Then Return
         
End


Public Sub Button3_Click()

   Message("Bitte das Programm neu starten, damit die Einstellungen wirksam werden.")
   eigeneEinstellung.Close
   AbfrageForm.Close
   TrayIcons.DeleteAll
   FMain.Close

End






Public Sub ComboBox1_DblClick()

    If ComboBox1.Text = "eigene Einstellung" Then eigeneEinstellung.Show

End

Public Sub Button1_Click()

   ' Die SSH Serverliste öffnen
   If sDateimanager = "Linux Mint 19 - Xfce" Then FMain.sManager = "thunar"
   If sDateimanager = "Linux Mint 19 - Mate" Then FMain.sManager = "caja"
   If sDateimanager = "Linux Mint 19 - Cinnamon" Then FMain.sManager = "nemo" 
   If sDateimanager = "Ubuntu 18.04" Then FMain.sManager = "nautilus"
   If sDateimanager = "Kubuntu 18.04" Then FMain.sManager = "dolphin"
   If sDateimanager = "eigene Einstellung" Then FMain.sManager = FMain.sGlobal1
   

   Shell FMain.sManager & " -- ~/.ssh/known_hosts"

End

Public Sub TextBox1_KeyPress()

   

End
