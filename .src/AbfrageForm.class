' Gambas class file

'Systemeinstellungen
Public sDistribution As String      'überflüssig?
Public sDateimanager As String
Public sTerminal As String

'Servereinstellungen
Public sServerIP1 As String
Public sBenutzer1 As String
Public sPort1 As String
Public sServerName1 As String

Public sServerIP2 As String
Public sBenutzer2 As String
Public sPort2 As String
Public sServerName2 As String

Public sServerIP3 As String
Public sBenutzer3 As String
Public sPort3 As String
Public sServerName3 As String

Public sServerIP4 As String
Public sBenutzer4 As String
Public sPort4 As String
Public sServerName4 As String



Public Sub Form_Open()

Dim hFile As Stream
Dim sLine1 As String     ' Dateimanager
Dim sLine2 As String    ' Terminal
Dim sLine3 As String    ' ServerIP1
Dim sLine4 As String    ' Benutzername1
Dim sLine5 As String    ' SSH Port1
Dim sLine6 As String    ' Servername1
Dim sLine7 As String    ' ServerIP2
Dim sLine8 As String    ' Benutzername2
Dim sLine9 As String    ' SSH Port2
Dim sLine10 As String    ' Servername2
Dim sLine11 As String    ' ServerIP3
Dim sLine12 As String    ' Benutzername3
Dim sLine13 As String    ' SSH Port3
Dim sLine14 As String    ' Servername3
Dim sLine15 As String    ' ServerIP4
Dim sLine16 As String    ' Benutzername4
Dim sLine17 As String    ' SSH Port4
Dim sLine18 As String    ' Servername4


hFile = Open "~/.datascp.txt" For Read       'Datei öffnen und einlesen

   Line Input #hFile, sLine1
   Line Input #hFile, sLine2
   Line Input #hFile, sLine3
   Line Input #hFile, sLine4
   Line Input #hFile, sLine5
   Line Input #hFile, sLine6
   Line Input #hFile, sLine7
   Line Input #hFile, sLine8
   Line Input #hFile, sLine9
   Line Input #hFile, sLine10
   Line Input #hFile, sLine11
   Line Input #hFile, sLine12
   Line Input #hFile, sLine13
   Line Input #hFile, sLine14
   Line Input #hFile, sLine15
   Line Input #hFile, sLine16
   Line Input #hFile, sLine17
   Line Input #hFile, sLine18

    '  Print sLine, sLine2, sLine3, sLine4, sLine5
   
    sDateimanager = sLine1
    sTerminal = sLine2
    
    sServerIP1 = sLine3
    sBenutzer1 = sLine4
    sPort1 = sLine5
    sServerName1 = sLine6
    sServerIP2 = sLine7
    sBenutzer2 = sLine8
    sPort2 = sLine9
    sServerName2 = sLine10
    sServerIP3 = sLine11
    sBenutzer3 = sLine12
    sPort3 = sLine13
    sServerName3 = sLine14
    sServerIP4 = sLine15
    sBenutzer4 = sLine16
    sPort4 = sLine17
    sServerName4 = sLine18
  
   ' Felder mit den gelesenen Daten auffüllen
   TextBox1.Text = sServerIP1
   TextBox2.Text = sBenutzer1
   TextBox3.Text = sPort1
   TextBox4.Text = sServerName1
   TextBox7.Text = sServerIP2
   TextBox6.Text = sBenutzer2
   TextBox5.Text = sPort2
   TextBox8.Text = sServerName2
   TextBox11.Text = sServerIP3
   TextBox10.Text = sBenutzer3
   TextBox9.Text = sPort3
   TextBox12.Text = sServerName3
   TextBox15.Text = sServerIP4
   TextBox14.Text = sBenutzer4
   TextBox13.Text = sPort4
   TextBox16.Text = sServerName4

' Abfrage falls sLine1 leer sein sollte
If sDateimanager = "" Then ComboBox1.Text = "Linux auswählen"
If sLine1 > "" Then ComboBox1.Text = "eigene Einstellung"
If sLine1 = "nemo" Then ComboBox1.Text = "Linux Mint - Cinnamon"
If sLine1 = "thunar" Then ComboBox1.Text = "Linux Mint - Xfce"
If sLine1 = "caja" Then ComboBox1.Text = "Linux Mint - Mate" 
If sLine1 = "konsole" Then ComboBox1.Text = "Kubuntu"
If sLine1 = "nautilus" Then ComboBox1.Text = "Ubuntu"

If ComboBox1.Text = "Linux auswählen" Then TextBox1.Text = "Server IP-Adresse"
If ComboBox1.Text = "Linux auswählen" Then TextBox2.Text = "Benutzername auf dem Server"
If ComboBox1.Text = "Linux auswählen" Then TextBox3.Text = "SSH Port"
If ComboBox1.Text = "Linux auswählen" Then TextBox4.Text = "Serverbezeichnung"
If ComboBox1.Text = "eigene Einstellung" Then FMain.sGlobal2 = sTerminal
If ComboBox1.Text = "eigene Einstellung" Then FMain.sGlobal1 = sDateimanager

' Hier wird das richtige Terminal für die entsprechende Ubgebung gewählt
If ComboBox1.Text = "Linux Mint - Cinnamon" Then sTerminal = "gnome-terminal"
If ComboBox1.Text = "Linux Mint - Xfce" Then sTerminal = "xfce4-terminal"
If ComboBox1.Text = "Linux Mint - Mate" Then sTerminal = "mate-terminal" 
If ComboBox1.Text = "Kubuntu" Then sTerminal = "konsole"
If ComboBox1.Text = "Ubuntu" Then sTerminal = "gnome-terminal"

If Exist("~/DataSCP") = True Then Label1.Text = "Der Arbeitsordner existiert\nschon und befindet sich im \nHomeverzeichnis mit \nNamen DataSCP."

End


Public Sub Button5_Click()
   ' den SSH Server installieren
   If sTerminal = "xfce4-terminal" Then Shell sTerminal & " -x apt install openssh-server" Else Shell sTerminal & " -- apt install openssh-server" Wait

End


Public Sub Button7_Click()
   ' den Server wieder löschen
    If sTerminal = "xfce4-terminal" Then Shell sTerminal & " -x apt remove openssh-server" Else Shell sTerminal & " -- apt remove openssh-server" Wait 
       
End


Public Sub Button9_Click()
''die eingegeben Daten speichern  / eine einfache Routine ,die funktioniert !!!

   If Exist("~/DataSCP") = False Then Mkdir "~/DataSCP"                          'Abfrage ob Ordner existiert
  
   ' Hier wird das richtige Terminal für die entsprechende Ubgebung gewählt
   If ComboBox1.Text = "Linux Mint - Cinnamon" Then sTerminal = "gnome-terminal"
   If ComboBox1.Text = "Linux Mint - Cinnamon" Then sDateimanager = "nemo"
   If ComboBox1.Text = "Linux Mint - Xfce" Then sTerminal = "xfce4-terminal"
   If ComboBox1.Text = "Linux Mint - Xfce" Then sDateimanager = "thunar"
   If ComboBox1.Text = "Linux Mint - Mate" Then sTerminal = "mate-terminal" 
   If ComboBox1.Text = "Linux Mint - Mate" Then sDateimanager = "caja" 
   If ComboBox1.Text = "Kubuntu" Then sTerminal = "konsole"
   If ComboBox1.Text = "Kubuntu" Then sDateimanager = "dolphin"
   If ComboBox1.Text = "Ubuntu" Then sTerminal = "gnome-terminal"
   If ComboBox1.Text = "Ubuntu" Then sDateimanager = "nautilus"
   If ComboBox1.Text = "eigene Einstellung" Then sTerminal = FMain.sGlobal2
   If ComboBox1.Text = "eigene Einstellung" Then sDateimanager = FMain.sGlobal1

   sServerIP1 = TextBox1.Text
   sBenutzer1 = TextBox2.Text
   sPort1 = TextBox3.Text
   sServerName1 = TextBox4.Text
   sServerIP2 = TextBox7.Text
   sBenutzer2 = TextBox6.Text
   sPort2 = TextBox5.Text
   sServerName2 = TextBox8.Text
   sServerIP3 = TextBox11.Text
   sBenutzer3 = TextBox10.Text
   sPort3 = TextBox9.Text
   sServerName3 = TextBox12.Text
   sServerIP4 = TextBox15.Text
   sBenutzer4 = TextBox14.Text
   sPort4 = TextBox13.Text
   sServerName4 = TextBox16.Text
   
   If sPort1 = "SSH Port" Then sPort1 = "22"
   If sPort2 = "SSH Port" Then sPort2 = "22" 
   If sPort3 = "SSH Port" Then sPort3 = "22" 
   If sPort4 = "SSH Port" Then sPort4 = "22"  
  
   '' jetz werden die Daten in Zeilen gespeichert
   File.Save("~/.datascp.txt", sDateimanager & gb.NewLine & sTerminal & gb.NewLine & sServerIP1 & gb.NewLine & sBenutzer1 & gb.NewLine & sPort1 & gb.NewLine & sServerName1 & gb.NewLine & sServerIP2 & gb.NewLine & sBenutzer2 & gb.NewLine & sPort2 & gb.NewLine & sServerName2 & gb.NewLine & sServerIP3 & gb.NewLine & sBenutzer3 & gb.NewLine & sPort3 & gb.NewLine & sServerName3 & gb.NewLine & sServerIP4 & gb.NewLine & sBenutzer4 & gb.NewLine & sPort4 & gb.NewLine & sServerName4 & gb.NewLine)
   Catch
   If Error Then Message("Fehler", "ok")
   'If Error Then Return
  
End


Public Sub Button3_Click()
   'Fenster schließen
   Message("Bitte das Programm neu starten, damit die Einstellungen wirksam werden.")
   eigeneEinstellung.Close
   AbfrageForm.Close
   TrayIcons.DeleteAll
   FMain.Close

End


Public Sub ComboBox1_DblClick()
   'eigene Einstellungsdialog öffnen
    If ComboBox1.Text = "eigene Einstellung" Then eigeneEinstellung.Show

End


Public Sub Button1_Click()
   'Den Ordner der SSH Serverliste öffnen, um auf die Datei known_hosts zugreifen zu können
   Shell sDateimanager & " -- ~/.ssh/"

End
